# pre_create_command = <<-EOH
#   if Vagrant.has_plugin?('vagrant-cachier')
#     unless (is_windows)
#       puts 'hello world'
#       config.cache.scope = :box
#       config.cache.enable :generic, {
#         'wget' => { cache_dir: '/var/cache/wget' }
#       }
#     end
#   end
# EOH

---
driver:
  name: vagrant
  # pre_create_command
  # requite_chef_omnibus: '16.10.17'
  download_url: 'file:///c://local_binaries/chef-client-16.10.17-1-x64.msi'
  # chef_omnibus_install_options: -P chef-workstation   # not using
  customize:
    cpus: 4
    memory: 4096
    clipboard: bidirectional
    # natdnshostresolver1: 'on'  # not needed yet
    # natdnsproxy1: 'on'         # not needed yet
    # gui: true                  # not needed yet

transport:
  name: winrm
  elevated: true


provisioner:
  name: chef_zero
  # client_rb:                        # ability to add custom values to client.rb
  #   http_proxy: <%= ENV['http_proxy'] %>
  #   https_proxy: <%= ENV['http_proxy'] %>
  #   no_proxy: <%= ENV['no_proxy'] %>
  #   no_lazy_load: true

platforms:
  - name: windows-2016
  # os_type: windows
    driver_config:
      box: win2016_tas50 ## windows boxes should start with in, for some of the transport magic to just work.
      box_url: https://vagrantcloud.com/tas50/boxes/windows_2016/versions/202010.24.0/providers/virtualbox.box
      synced_folders:
        - [".", "/vagrant"] #, disabled: true ## https://github.com/test-kitchen/kitchen-vagrant/blob/master/templates/Vagrantfile.erb
        - ["../../binaries", "/local_binaries"] #, disabled: true ## https://github.com/test-kitchen/kitchen-vagrant/blob/master/templates/Vagrantfile.erb
      # transport:
      #   name: winrm
      #   elevated: true
      # memory: 4096
      # shared folder: vagrant: <current folder>
      # CPU: 2
      # remote_display - port 5956; auth Null; auth timeout 5000


suites:
  - name: default
    run_list: #uses policyfile
      - recipe[api_box::default]
      - recipe[api_box::eye_cli]
    # cookbook_path: '/cookbooks'
    # data_bags_path: '~/.chef/data_bags'
    # encrypted_data_bag_secret_key_path: '~/.chef/encrypted_data_bag_secret'
    # roles_path: '~/.chef/roles'
    # attributes:
    #   <cookbook_name>:
    #     <attribute_name>:
    #       attribute: "value"
    #     <another_attribute>:
    #       attribute: "value"
    verifier:
      name: inspec
    #     - cookbooks/api_box/test/integration/default/default_spec.rb
